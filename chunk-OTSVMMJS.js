import{a as Ke,b as Qe,c as Je,d as Xe,e as Ye,f as et,g as E,h as _e,i as it,j as ot,k as at}from"./chunk-6XFLKPQQ.js";import{a as fe}from"./chunk-3J7GGTVR.js";import{a as Ge,b as Ze}from"./chunk-YRGJMAXA.js";import{a as W,b as He}from"./chunk-W67WLBRR.js";import{a as me,b as de,c as tt,d as nt}from"./chunk-Z577BEOS.js";import{A as T,Aa as Re,B as M,Ba as Le,C as Se,D as ee,E as B,Ea as q,F as N,G as d,H as l,I as s,J as S,N as P,O as m,P as f,T as Pe,U as Fe,V as Ie,Wa as $e,X as ge,Xa as ne,Y as u,Z as U,_ as j,_a as ze,aa as Ee,ab as ie,ba as ke,bb as oe,ca as Te,cb as ae,da as Me,db as re,e as we,eb as De,f as b,fb as A,gb as I,h as C,ha as te,hb as Be,i as y,ia as h,ib as Ne,ja as g,k as X,kb as le,lb as se,ma as Oe,mb as pe,o as xe,ob as Ue,p as c,pa as F,pb as L,qa as x,qb as ce,rb as $,s as w,sa as Ae,sb as je,tb as qe,ua as Ve,ub as We,w as Y,x as R}from"./chunk-REBENH2H.js";import"./chunk-Q6FFIHTR.js";import"./chunk-6LGZ257D.js";import"./chunk-4QTIMY6T.js";import"./chunk-J7JDIHQK.js";import"./chunk-SDMJJ4FY.js";import"./chunk-GIIU5PV3.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-SPMQWSIB.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{g as v}from"./chunk-2R6CW7ES.js";var V=function(o){return o.Prompt="PROMPT",o.Camera="CAMERA",o.Photos="PHOTOS",o}(V||{}),K=function(o){return o.Rear="REAR",o.Front="FRONT",o}(K||{}),ve=function(o){return o.Uri="uri",o.Base64="base64",o.DataUrl="dataUrl",o}(ve||{});var Q=class extends nt{getPhoto(n){return v(this,null,function*(){return new Promise((r,t)=>v(this,null,function*(){if(n.webUseInput||n.source===V.Photos)this.fileInputExperience(n,r,t);else if(n.source===V.Prompt){let e=document.querySelector("pwa-action-sheet");e||(e=document.createElement("pwa-action-sheet"),document.body.appendChild(e)),e.header=n.promptLabelHeader||"Photo",e.cancelable=!1,e.options=[{title:n.promptLabelPhoto||"From Photos"},{title:n.promptLabelPicture||"Take Picture"}],e.addEventListener("onSelection",i=>v(this,null,function*(){i.detail===0?this.fileInputExperience(n,r,t):this.cameraExperience(n,r,t)}))}else this.cameraExperience(n,r,t)}))})}pickImages(n){return v(this,null,function*(){return new Promise((r,t)=>v(this,null,function*(){this.multipleFileInputExperience(r,t)}))})}cameraExperience(n,r,t){return v(this,null,function*(){if(customElements.get("pwa-camera-modal")){let e=document.createElement("pwa-camera-modal");e.facingMode=n.direction===K.Front?"user":"environment",document.body.appendChild(e);try{yield e.componentOnReady(),e.addEventListener("onPhoto",i=>v(this,null,function*(){let a=i.detail;a===null?t(new me("User cancelled photos app")):a instanceof Error?t(a):r(yield this._getCameraPhoto(a,n)),e.dismiss(),document.body.removeChild(e)})),e.present()}catch{this.fileInputExperience(n,r,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(n,r,t)})}fileInputExperience(n,r,t){let e=document.querySelector("#_capacitor-camera-input"),i=()=>{var a;(a=e.parentNode)===null||a===void 0||a.removeChild(e)};e||(e=document.createElement("input"),e.id="_capacitor-camera-input",e.type="file",e.hidden=!0,document.body.appendChild(e),e.addEventListener("change",a=>{let p=e.files[0],_="jpeg";if(p.type==="image/png"?_="png":p.type==="image/gif"&&(_="gif"),n.resultType==="dataUrl"||n.resultType==="base64"){let k=new FileReader;k.addEventListener("load",()=>{if(n.resultType==="dataUrl")r({dataUrl:k.result,format:_});else if(n.resultType==="base64"){let J=k.result.split(",")[1];r({base64String:J,format:_})}i()}),k.readAsDataURL(p)}else r({webPath:URL.createObjectURL(p),format:_}),i()}),e.addEventListener("cancel",a=>{t(new me("User cancelled photos app")),i()})),e.accept="image/*",e.capture=!0,n.source===V.Photos||n.source===V.Prompt?e.removeAttribute("capture"):n.direction===K.Front?e.capture="user":n.direction===K.Rear&&(e.capture="environment"),e.click()}multipleFileInputExperience(n,r){let t=document.querySelector("#_capacitor-camera-input-multiple"),e=()=>{var i;(i=t.parentNode)===null||i===void 0||i.removeChild(t)};t||(t=document.createElement("input"),t.id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",i=>{let a=[];for(let p=0;p<t.files.length;p++){let _=t.files[p],k="jpeg";_.type==="image/png"?k="png":_.type==="image/gif"&&(k="gif"),a.push({webPath:URL.createObjectURL(_),format:k})}n({photos:a}),e()}),t.addEventListener("cancel",i=>{r(new me("User cancelled photos app")),e()})),t.accept="image/*",t.click()}_getCameraPhoto(n,r){return new Promise((t,e)=>{let i=new FileReader,a=n.type.split("/")[1];r.resultType==="uri"?t({webPath:URL.createObjectURL(n),format:a,saved:!1}):(i.readAsDataURL(n),i.onloadend=()=>{let p=i.result;r.resultType==="dataUrl"?t({dataUrl:p,format:a,saved:!1}):t({base64String:p.split(",")[1],format:a,saved:!1})},i.onerror=p=>{e(p)})})}checkPermissions(){return v(this,null,function*(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}})}requestPermissions(){return v(this,null,function*(){throw this.unimplemented("Not implemented on web.")})}pickLimitedLibraryPhotos(){return v(this,null,function*(){throw this.unavailable("Not implemented on web.")})}getLimitedLibraryPhotos(){return v(this,null,function*(){throw this.unavailable("Not implemented on web.")})}},At=new Q;var Ce=tt("Camera",{web:()=>new Q});function gt(o,n){if(o&1){let r=P();l(0,"div",1),S(1,"ion-img",4),l(2,"ion-icon",5),m("click",function(e){C(r);let i=f();return y(i.deleteImage(e))}),s()()}if(o&2){let r=f();c(),d("src",r.image)}}function ft(o,n){o&1&&(l(0,"ion-text",2),u(1,"Bild hinzuf\xFCgen"),s())}var rt=(()=>{let n=class n{ngOnChanges(t){return v(this,null,function*(){if(t.value&&this.value){let e=this.detectType(this.value);switch(console.log("Image value changed:",this.value,"\u2192",e),e){case"index":let i=yield W.images.get(Number(this.value));this.image=i?URL.createObjectURL(i.data):void 0;break;case"filesystem":let a=yield ot(this.value);this.image=a;break;case"temporary":this.image=this.value;break}}})}detectType(t){return/^\d+$/.test(t)?"index":/^[^/]+?\.(jpe?g|png|gif)$/i.test(t)?"filesystem":"temporary"}constructor(){this.valueChange=new R,this.image=void 0,this.actionSheetButtons=[{text:"Kamera",icon:"camera",role:"camera",handler:()=>this.pickImage(V.Camera),data:{action:"camera"}},{text:"Galerie",icon:"image",role:"gallery",handler:()=>this.pickImage(V.Photos),data:{action:"gallery"}},{text:"Abbrechen",icon:"close",role:"cancel",data:{action:"cancel"}}]}pickImage(t){return v(this,null,function*(){de.getPlatform()!=="web"&&(yield Ce.requestPermissions({permissions:["camera","photos"]}));try{let e=yield Ce.getPhoto({quality:90,allowEditing:!1,resultType:ve.Uri,source:t});this.value=e.webPath,this.valueChange.emit(this.value)}catch(e){console.error("Image pick failed:",e)}})}deleteImage(t){t.stopPropagation(),this.valueChange.emit("")}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-image-picker"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},features:[X],decls:4,vars:2,consts:[["id","open-action-sheet",1,"img-container"],[1,"image-wrapper"],["color","medium"],["trigger","open-action-sheet","header","Actions",3,"buttons"],[1,"image-preview",3,"src"],["name","trash-outline",1,"delete-icon",3,"click"]],template:function(e,i){e&1&&(l(0,"div",0),T(1,gt,3,1,"div",1)(2,ft,2,0,"ion-text",2),s(),S(3,"ion-action-sheet",3)),e&2&&(c(),M(i.value?1:2),c(2),d("buttons",i.actionSheetButtons))},dependencies:[ce,De,le,ze],styles:[".image-wrapper[_ngcontent-%COMP%]{position:relative;height:100%;width:100%}.delete-icon[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;font-size:24px;color:#fff;background-color:#00000080;border-radius:50%;padding:4px;cursor:pointer;z-index:10}"]});let o=n;return o})();var G=["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"];var _t=(o,n)=>({lower:o,upper:n});function vt(o,n){if(o&1&&(l(0,"div",3)(1,"div",4),u(2),h(3,"commaDecimal"),s(),l(4,"div",5),u(5),h(6,"commaDecimal"),s()()),o&2){let r=f();c(2),U(g(3,2,r.range[r.lower])),c(3),U(g(6,4,r.range[r.upper]))}}var ue=(()=>{let n=class n{constructor(){this.range=[],this.valueChange=new R,this.min=0,this.max=0,this.lower=0,this.upper=0}ngOnChanges(t){t.range&&(this.max=this.range.length-1),t.value&&this.value&&(this.lower=this.getIndex(this.value.start,0),this.upper=this.getIndex(this.value.end,this.range.length-1))}getIndex(t,e){let i=this.range.indexOf(t);return i>=0?i:e}onChange(t){let{lower:e,upper:i}=t.detail.value,a=this.range[e],p=this.range[i];this.valueChange.emit({start:a,end:p})}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-range-slider"]],inputs:{label:"label",range:"range",value:"value"},outputs:{valueChange:"valueChange"},features:[X],decls:6,vars:9,consts:[[1,"range-slider-container"],[1,"ion-margin-horizontal"],["dualKnobs","true","snaps","true",3,"ionInput","min","max","step","value"],[1,"range-labels"],[1,"label","left"],[1,"label","right"]],template:function(e,i){e&1&&(l(0,"div",0)(1,"ion-text"),u(2),s(),l(3,"div",1)(4,"ion-range",2),m("ionInput",function(p){return i.onChange(p)}),s(),T(5,vt,7,6,"div",3),s()()),e&2&&(c(2),U(i.label),c(2),d("min",i.min)("max",i.max)("step",1)("value",te(6,_t,i.lower,i.upper)),c(),M(i.range.length>0?5:-1))},dependencies:[je,le,at],styles:["[_nghost-%COMP%]{width:100%}.range-slider-container[_ngcontent-%COMP%]{width:100%;padding:16px 0}.range-labels[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding-top:4px;font-weight:700;font-size:14px;color:#2c3e50}.custom-range[_ngcontent-%COMP%]{--bar-background: #bdc3c7;--bar-background-active: #1abc9c;--knob-size: 24px;--knob-background: #2ecc71}"]});let o=n;return o})();var lt=[.5,.6,.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5,2,2.5,3,3.5,4,4.5,5,6,7,8,9,10];var Ct=(o,n)=>({"label-selected":o,"only-label":n});function yt(o,n){if(o&1&&S(0,"img",5),o&2){let r=f().$implicit,t=f();ge("icon-selected",t.value===r.value),d("alt",Me(r.label))("src",r.icon,xe)}}function bt(o,n){if(o&1){let r=P();l(0,"div",2),m("click",function(){let e=C(r).$implicit,i=f();return y(i.select(e.value))}),T(1,yt,1,5,"img",3),l(2,"span",4),u(3),s()()}if(o&2){let r=n.$implicit,t=f();ge("selected",t.value===r.value),c(),M(r.icon?1:-1),c(),d("ngClass",te(5,Ct,t.value===r.value,!r.icon)),c(),j(" ",r.label," ")}}var he=(()=>{let n=class n{constructor(){this.valueChange=new R,this.options=[]}select(t){this.valueChange.emit(t)}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-selector"]],inputs:{value:"value",options:"options"},outputs:{valueChange:"valueChange"},decls:3,vars:0,consts:[[1,"container"],[1,"option",3,"selected"],[1,"option",3,"click"],[1,"icon",3,"src","icon-selected","alt"],[1,"label",3,"ngClass"],[1,"icon",3,"src","alt"]],template:function(e,i){e&1&&(l(0,"div",0),B(1,bt,4,8,"div",1,ee),s()),e&2&&(c(),N(i.options))},dependencies:[x,Oe],styles:["[_nghost-%COMP%]{width:100%}.container[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:16px;justify-content:space-between;margin:16px;flex-wrap:wrap}.option[_ngcontent-%COMP%]{align-items:center;padding:12px;border-radius:8px;background-color:#f0f0f0;flex:1;max-width:100px;text-align:center;cursor:pointer;display:flex;flex-direction:column}.selected[_ngcontent-%COMP%]{background-color:#74b816}.icon[_ngcontent-%COMP%]{width:32px;height:32px;filter:brightness(.3)}.icon-selected[_ngcontent-%COMP%]{filter:brightness(1) invert(1)}.label[_ngcontent-%COMP%]{margin-top:4px;font-size:12px;color:#333}.label-selected[_ngcontent-%COMP%]{color:#fff;font-weight:700}.only-label[_ngcontent-%COMP%]{font-size:18px}"]});let o=n;return o})();var st=(()=>{let n=class n{constructor(){this.plantFormService=b(E),this.plantForm$=this.plantFormService.plantForm$,this.options=Object.values(Ke).map(t=>({value:t,label:Qe[t],icon:Je[t]}))}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-light-selector"]],decls:4,vars:4,consts:[[1,"ion-margin-top"],[3,"valueChange","value","options"]],template:function(e,i){if(e&1&&(l(0,"ion-label",0),u(1,` Standort
`),s(),l(2,"app-selector",1),h(3,"async"),m("valueChange",function(p){return i.plantFormService.update("light",p)}),s()),e&2){let a;c(2),d("value",(a=g(3,2,i.plantForm$))==null?null:a.light)("options",i.options)}},dependencies:[he,x,I,F],styles:["[_nghost-%COMP%]{width:100%}"]});let o=n;return o})();var H=(()=>{let n=class n{constructor(){this.table=W.choices}addChoices(t){return v(this,null,function*(){return yield this.table.add(t)})}getChoicesByName(t){return v(this,null,function*(){let e=yield this.table.where("name").equals(t).first();return e?e.value:(yield this.table.add({name:t,value:[]}),[])})}addValue(t,e){return v(this,null,function*(){let i=yield this.table.where("name").equals(t).first();i?i.value.includes(e)||(i.value.push(e),yield this.table.update(i.id,{value:i.value})):yield this.table.add({name:t,value:[e]})})}removeValue(t,e){return v(this,null,function*(){let i=yield this.table.where("name").equals(t).first();if(i){let a=i.value.filter(p=>p!==e);yield this.table.update(i.id,{value:a})}})}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=we({token:n,factory:n.\u0275fac,providedIn:"root"});let o=n;return o})();function wt(o,n){if(o&1&&(l(0,"ion-select-option",2),u(1),s()),o&2){let r=n.$implicit;d("value",r),c(),j(" ",r," ")}}function xt(o,n){if(o&1){let r=P();l(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),u(3,"Neuen Eintrag hinzuf\xFCgen"),s(),l(4,"ion-buttons",6)(5,"ion-button",7),m("click",function(){C(r);let e=f();return y(e.closeAddModal())}),u(6,"Abbrechen"),s()()()(),l(7,"ion-content")(8,"ion-item")(9,"ion-input",8),Te("ngModelChange",function(e){C(r);let i=f();return ke(i.newOption,e)||(i.newOption=e),y(e)}),s()(),l(10,"ion-button",9),m("click",function(){C(r);let e=f();return y(e.addNewOption())}),u(11,"Hinzuf\xFCgen"),s()()}if(o&2){let r=f();c(9),Ee("ngModel",r.newOption)}}var Z=(()=>{let n=class n{constructor(){this.choiceStorageService=b(H),this.selected=void 0,this.selectedChange=new R,this.options=[],this.showAddModal=!1,this.newOption=""}ngOnInit(){this.getOptions()}openAddItemModal(){this.showAddModal=!0,this.newOption=""}closeAddModal(){this.showAddModal=!1}addNewOption(){return v(this,null,function*(){this.newOption.trim()&&(this.selected=this.newOption.trim(),yield this.choiceStorageService.addValue(this.choiceName,this.selected),this.selectedChange.emit(this.selected),this.closeAddModal(),this.getOptions())})}onSelectChange(t){this.selected=t,this.selectedChange.emit(t)}getOptions(){return v(this,null,function*(){this.options=yield this.choiceStorageService.getChoicesByName(this.choiceName)})}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-choices"]],inputs:{selected:"selected",choiceName:"choiceName"},outputs:{selectedChange:"selectedChange"},decls:8,vars:4,consts:[["lines","none"],["okText","OK","cancelText","Abbrechen","fill","solid",3,"ionChange","value","disabled","placeholder"],[3,"value"],["fill","clear","slot","end","size","large",3,"click"],["name","add-circle-outline"],[3,"didDismiss","isOpen"],["slot","end"],[3,"click"],["placeholder","Neuen Wert eingeben",3,"ngModelChange","ngModel"],["expand","block",3,"click"]],template:function(e,i){e&1&&(l(0,"ion-item",0)(1,"ion-select",1),m("ionChange",function(p){return i.onSelectChange(p.detail.value)}),B(2,wt,2,2,"ion-select-option",2,Se),s(),l(4,"ion-button",3),m("click",function(){return i.openAddItemModal()}),S(5,"ion-icon",4),s()(),l(6,"ion-modal",5),m("didDismiss",function(){return i.closeAddModal()}),Y(7,xt,12,1,"ng-template"),s()),e&2&&(c(),d("value",i.selected)("disabled",i.options.length===0)("placeholder",i.options.length===0?"Typen hinzuf\xFCgen":"Auswahl"),c(),N(i.options),c(4),d("isOpen",i.showAddModal))},dependencies:[x,A,Ne,ie,ce,qe,ne,re,pe,se,oe,ae,$,q,Re,Le],styles:["ion-select[_ngcontent-%COMP%]::part(icon){position:absolute;right:16px}ion-select[_ngcontent-%COMP%]::part(text){overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block}div[_ngcontent-%COMP%]{display:flex;flex-direction:row;padding-top:16px}"]});let o=n;return o})();var D=function(o){return o.PlantType="plantType",o.FertilizerType="fertilizerType",o.SoilType="soilType",o}(D||{});var pt=(()=>{let n=class n{constructor(){this.plantFormService=b(E),this.plantForm$=this.plantFormService.plantForm$,this.ChoiceName=D}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-soil"]],decls:5,vars:4,consts:[[3,"selectedChange","choiceName","selected"]],template:function(e,i){if(e&1&&(l(0,"div")(1,"ion-label"),u(2,"Erde"),s(),l(3,"app-choices",0),h(4,"async"),m("selectedChange",function(p){return i.plantFormService.update("soil",p)}),s()()),e&2){let a;c(3),d("choiceName",i.ChoiceName.SoilType)("selected",(a=g(4,2,i.plantForm$))==null?null:a.soil)}},dependencies:[x,q,I,Z,F],styles:["[_nghost-%COMP%]{width:100%}div[_ngcontent-%COMP%]{width:100%;padding:16px 0}"]});let o=n;return o})();function St(o,n){if(o&1){let r=P();l(0,"app-choices",2),h(1,"async"),m("selectedChange",function(e){C(r);let i=f();return y(i.plantFormService.update("fertilization.type",e))}),s(),l(2,"ion-input",3),h(3,"async"),m("ionChange",function(e){C(r);let i=f();return y(i.plantFormService.update("fertilization.time",e.detail.value??""))}),s()}if(o&2){let r,t,e=f();d("choiceName",e.ChoiceName.FertilizerType)("selected",(r=g(1,3,e.plantForm$))==null||r.fertilization==null?null:r.fertilization.type),c(2),d("value",(t=g(3,5,e.plantForm$))==null||t.fertilization==null?null:t.fertilization.time)}}var ct=(()=>{let n=class n{constructor(){this.plantFormService=b(E),this.plantForm$=this.plantFormService.plantForm$,this.choiceStorageService=b(H),this.ChoiceName=D}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-fertilization"]],decls:7,vars:6,consts:[["lines","none",1,"ion-no-padding"],["slot","end",3,"ionChange","checked"],[3,"selectedChange","choiceName","selected"],["label","Zeitpunkt","placeholder","Enter text",1,"ion-padding-start",3,"ionChange","value"]],template:function(e,i){if(e&1&&(l(0,"ion-item",0)(1,"ion-label"),u(2,"D\xFCnger"),s(),l(3,"ion-checkbox",1),h(4,"async"),m("ionChange",function(p){return i.plantFormService.update("fertilization.enabled",p.detail.checked)}),s()(),T(5,St,4,7),h(6,"async")),e&2){let a,p;c(3),d("checked",(a=g(4,2,i.plantForm$))==null||a.fertilization==null?null:a.fertilization.enabled),c(2),M(!((p=g(6,4,i.plantForm$))==null||p.fertilization==null)&&p.fertilization.enabled?5:-1)}},dependencies:[I,Z,x,L,A,$,F],styles:["[_nghost-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]{--padding-end: 0px;--inner-padding-end: 0px}"]});let o=n;return o})();var mt=(()=>{let n=class n{constructor(){this.plantFormService=b(E),this.plantForm$=this.plantFormService.plantForm$,this.options=Object.values(Xe).map(t=>({value:t,label:Ye[t],icon:et[t]}))}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-water-selector"]],decls:5,vars:4,consts:[[1,"ion-margin-top"],[3,"valueChange","value","options"]],template:function(e,i){if(e&1&&(l(0,"div")(1,"ion-label",0),u(2," Gie\xDFen "),s(),l(3,"app-selector",1),h(4,"async"),m("valueChange",function(p){return i.plantFormService.update("watering",p)}),s()()),e&2){let a;c(3),d("value",(a=g(4,2,i.plantForm$))==null?null:a.watering)("options",i.options)}},dependencies:[I,he,x,F],styles:["[_nghost-%COMP%]{width:100%}"]});let o=n;return o})();var dt=(()=>{let n=class n{constructor(){this.plantFormService=b(E),this.choiceStorageService=b(H),this.plantForm$=this.plantFormService.plantForm$,this.ChoiceName=D}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-plant-type"]],decls:5,vars:4,consts:[[3,"selectedChange","choiceName","selected"]],template:function(e,i){if(e&1&&(l(0,"div")(1,"ion-label"),u(2," Art "),s(),l(3,"app-choices",0),h(4,"async"),m("selectedChange",function(p){return i.plantFormService.update("type",p)}),s()()),e&2){let a;c(3),d("choiceName",i.ChoiceName.PlantType)("selected",(a=g(4,2,i.plantForm$))==null?null:a.type)}},dependencies:[I,Z,x,F],styles:["[_nghost-%COMP%]{width:100%;padding:16px 0}"]});let o=n;return o})();function Pt(o,n){if(o&1){let r=P();l(0,"ion-input",2),h(1,"async"),m("ionChange",function(e){C(r);let i=f();return y(i.plantFormService.update("pruning.time",e.detail.value??""))}),s(),l(2,"ion-input",3),h(3,"async"),m("ionChange",function(e){C(r);let i=f();return y(i.plantFormService.update("pruning.amount",e.detail.value??""))}),s()}if(o&2){let r,t,e=f();d("value",(r=g(1,2,e.plantForm$))==null||r.pruning==null?null:r.pruning.time),c(2),d("value",(t=g(3,4,e.plantForm$))==null||t.pruning==null?null:t.pruning.amount)}}var ut=(()=>{let n=class n{constructor(){this.plantFormService=b(E),this.plantForm$=this.plantFormService.plantForm$,this.monthRange=G}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-pruning"]],decls:7,vars:6,consts:[["lines","none",1,"ion-no-padding"],["slot","end",3,"ionChange","checked"],["label","Wann","placeholder","Enter text",1,"ion-padding-start",3,"ionChange","value"],["label","Wie viel","placeholder","Enter text",1,"ion-padding-start",3,"ionChange","value"]],template:function(e,i){if(e&1&&(l(0,"ion-item",0)(1,"ion-label"),u(2," R\xFCckschnitt "),s(),l(3,"ion-checkbox",1),h(4,"async"),m("ionChange",function(p){return i.plantFormService.update("pruning.enabled",p.detail.checked)}),s()(),T(5,Pt,4,6),h(6,"async")),e&2){let a,p;c(3),d("checked",(a=g(4,2,i.plantForm$))==null||a.pruning==null?null:a.pruning.enabled),c(2),M(!((p=g(6,4,i.plantForm$))==null||p.pruning==null)&&p.pruning.enabled?5:-1)}},dependencies:[I,L,x,$,A,F],styles:["[_nghost-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]{--padding-end: 0px;--inner-padding-end: 0px}"]});let o=n;return o})();function Ft(o,n){if(o&1){let r=P();l(0,"app-range-slider",3),h(1,"async"),m("valueChange",function(e){C(r);let i=f();return y(i.plantFormService.update("fruit.time",e))}),s()}if(o&2){let r,t=f();d("range",t.monthRange)("value",(r=g(1,2,t.plantForm$))==null||r.fruit==null?null:r.fruit.time)}}var ht=(()=>{let n=class n{constructor(){this.plantFormService=b(E),this.plantForm$=this.plantFormService.plantForm$,this.monthRange=G}ngOnInit(){}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-fruit"]],decls:7,vars:6,consts:[["lines","none",1,"ion-no-padding"],["slot","end",3,"ionChange","checked"],["label","Zeitraum:",3,"range","value"],["label","Zeitraum:",3,"valueChange","range","value"]],template:function(e,i){if(e&1&&(l(0,"ion-item",0)(1,"ion-label"),u(2,"Frucht"),s(),l(3,"ion-checkbox",1),h(4,"async"),m("ionChange",function(p){return i.plantFormService.update("fruit.enabled",p.detail.checked)}),s()(),T(5,Ft,2,4,"app-range-slider",2),h(6,"async")),e&2){let a,p;c(3),d("checked",(a=g(4,2,i.plantForm$))==null||a.fruit==null?null:a.fruit.enabled),c(2),M(!((p=g(6,4,i.plantForm$))==null||p.fruit==null)&&p.fruit.enabled?5:-1)}},dependencies:[A,I,L,ue,x,F],styles:["[_nghost-%COMP%]{width:100%}ion-item[_ngcontent-%COMP%]{--padding-end: 0px;--inner-padding-end: 0px}"]});let o=n;return o})();var It=["dialog"];function Et(o,n){if(o&1){let r=P();l(0,"ion-item")(1,"ion-label"),u(2),s(),l(3,"ion-checkbox",15),h(4,"async"),m("ionChange",function(e){let i=C(r).$implicit,a=f();return y(a.plantFormService.update(i,e.detail.checked))}),s()()}if(o&2){let r,t=n.$implicit,e=f();c(2),U(e.checkboxLabels[t]),c(),d("checked",(r=g(4,2,e.plantForm$))==null?null:r[t])}}function kt(o,n){if(o&1){let r=P();l(0,"div",16)(1,"h1"),u(2,"Was m\xF6chtest du machen?"),s(),l(3,"div",17)(4,"ion-button",18),m("click",function(){C(r);let e=f();return y(e.saveAndAddAnother())}),u(5," Speichern und neue Pflanze hinzuf\xFCgen "),s(),l(6,"ion-button",19),m("click",function(){C(r);let e=f();return y(e.saveAndView())}),u(7," Speichern "),s()()()}}var oo=(()=>{let n=class n{constructor(){this.plantFormService=b(E),this.plantStorageService=b(He),this.collectionStorageService=b(Ge),this.route=b(Ae),this.router=b(Ve),this.alertCtrl=b(Ue),this.plantForm$=this.plantFormService.plantForm$,this.monthRange=G,this.distanceRange=lt,this.parentId=null,this.isEditMode=!1,this.lastAddedPlantId=null,this.checkboxFields=["frostResistant","leaf","dryTolerance","edible","toxic","fragrant","buckets"],this.checkboxLabels={frostResistant:"Frosthart",leaf:"Bl\xE4tter",dryTolerance:"Trockenresistent",edible:"Essbar",toxic:"Giftig",fragrant:"Duftend",buckets:"Topfgeeignet"}}ngOnInit(){this.route.queryParams.subscribe(t=>{let e=t.parentId,i=t.editId;e&&(this.parentId=Number(e)),i&&(this.isEditMode=!0)})}savePlant(){return v(this,null,function*(){let t=this.plantFormService.getPlant();this.parentId||(t.initialId=Ze(t.nameLatin));let e=this.validatePlant(t);if(e.length>0){yield(yield this.alertCtrl.create({header:"Fehler",message:e.join(`
`),cssClass:"custom-alert",buttons:["OK"]})).present();return}try{this.isEditMode?yield this.updatePlant(t):yield this.createPlant(t),yield this.modal.present()}catch(i){console.error("Failed to save plant:",i)}})}createPlant(t){return v(this,null,function*(){t.imageUrl&&(t.imageUrl=yield this.saveImageInStore(t.imageUrl));let e=yield this.plantStorageService.addPlant(t);this.parentId&&(yield this.collectionStorageService.addChild(this.parentId,e,"plant")),this.lastAddedPlantId=e})}updatePlant(t){return v(this,null,function*(){let e=yield this.plantStorageService.getPlant(t.id);t.imageUrl&&t.imageUrl!==e?.imageUrl&&(t.imageUrl=yield this.saveImageInStore(t.imageUrl)),yield this.plantStorageService.updatePlant(t.id,t),this.lastAddedPlantId=t.id})}saveAndAddAnother(){this.plantFormService.reset(),this.lastAddedPlantId=null,this.modal.dismiss()}saveAndView(){this.plantFormService.reset(),this.router.navigate(["/plant",this.lastAddedPlantId]),this.lastAddedPlantId=null,this.modal.dismiss()}validatePlant(t){let e=[];return t.nameLatin?.trim()||e.push("Der lateinische Name darf nicht leer sein."),t.nameGerman?.trim()||e.push("Der deutsche Name darf nicht leer sein."),t.pruning.enabled&&(t.pruning.time?.trim()||e.push("Zeit darf nicht leer sein, wenn R\xFCckschnitt aktiviert ist."),t.pruning.amount?.trim()||e.push("Menge darf nicht leer sein, wenn R\xFCckschnitt aktiviert ist.")),t.fertilization.enabled&&(t.fertilization.type?.trim()||e.push("Typ darf nicht leer sein, wenn D\xFCnger aktiviert ist."),t.fertilization.time?.trim()||e.push("Zeit darf nicht leer sein, wenn D\xFCnger aktiviert ist.")),e}saveImageInStore(t){return v(this,null,function*(){if(de.getPlatform()==="web"){let e=yield fetch(t).then(a=>a.blob()),i=yield W.images.add({name:Date.now().toString(),data:e});return String(i)}else{let e=`${Date.now()}.jpeg`,a=`Pictures/PflanzenABC/${e}`;if(t.startsWith("file://"))yield _e.copy({from:t,to:a,directory:fe.ExternalStorage});else{let p=yield fetch(t).then(k=>k.blob()),_=yield it(p);yield _e.writeFile({path:a,data:_.split(",")[1],directory:fe.ExternalStorage,recursive:!0})}return e}})}ngOnDestroy(){this.plantFormService.reset()}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=w({type:n,selectors:[["app-add-plant"]],viewQuery:function(e,i){if(e&1&&Pe(It,5),e&2){let a;Fe(a=Ie())&&(i.modal=a.first)}},decls:51,vars:27,consts:[["dialog",""],[3,"translucent"],["slot","start"],["defaultHref","/home"],[3,"fullscreen"],[1,"safe-area"],[3,"valueChange","value"],["label","Lateinischer Name","labelPlacement","floating","placeholder","Enter text",3,"ionChange","value"],["label","Deutscher Name","labelPlacement","floating","placeholder","Enter text",3,"ionChange","value"],["label","Gr\xF6\xDFe:",3,"valueChange","range","value"],["label","Bl\xFCte-/Erntezeit:",3,"valueChange","range","value"],["label","Abstand zu anderen:",3,"valueChange","range","value"],["label","Notizen/Pflege/Schritt","labelPlacement","floating","fill","outline","placeholder","Enter text","autoGrow","true",1,"text-area",3,"ionChange","value"],["expand","block","shape","round",3,"click"],["id","dialog"],["slot","end",3,"ionChange","checked"],[1,"wrapper"],[1,"button-row"],["expand","block","color","primary",1,"ion-margin-bottom",3,"click"],["expand","block","color","primary",3,"click"]],template:function(e,i){if(e&1){let a=P();l(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),S(3,"ion-back-button",3),s(),l(4,"ion-title"),u(5),s()()(),l(6,"ion-content",4)(7,"div",5)(8,"ion-list")(9,"ion-list")(10,"app-image-picker",6),h(11,"async"),m("valueChange",function(_){return C(a),y(i.plantFormService.update("imageUrl",_))}),s()(),l(12,"ion-item")(13,"ion-input",7),h(14,"async"),m("ionChange",function(_){return C(a),y(i.plantFormService.update("nameLatin",_.detail.value??""))}),s()(),l(15,"ion-item")(16,"ion-input",8),h(17,"async"),m("ionChange",function(_){return C(a),y(i.plantFormService.update("nameGerman",_.detail.value??""))}),s()(),l(18,"ion-item"),S(19,"app-plant-type"),s(),l(20,"ion-item")(21,"app-range-slider",9),h(22,"async"),m("valueChange",function(_){return C(a),y(i.plantFormService.update("height",_))}),s()(),l(23,"ion-item")(24,"app-range-slider",10),h(25,"async"),m("valueChange",function(_){return C(a),y(i.plantFormService.update("bloomTime",_))}),s()(),l(26,"ion-item"),S(27,"app-soil"),s(),l(28,"ion-item"),S(29,"app-fertilization"),s(),l(30,"ion-item")(31,"app-range-slider",11),h(32,"async"),m("valueChange",function(_){return C(a),y(i.plantFormService.update("distance",_))}),s()(),l(33,"ion-item"),S(34,"app-pruning"),s(),l(35,"ion-item"),S(36,"app-water-selector"),s(),l(37,"ion-item"),S(38,"app-light-selector"),s(),l(39,"ion-item"),S(40,"app-fruit"),s(),B(41,Et,5,4,"ion-item",null,ee),l(43,"ion-item")(44,"ion-textarea",12),h(45,"async"),m("ionChange",function(_){return C(a),y(i.plantFormService.update("notice",_.detail.value??""))}),s()()(),l(46,"ion-button",13),m("click",function(){return C(a),y(i.savePlant())}),u(47,"Speichern"),s()()(),l(48,"ion-modal",14,0),Y(50,kt,8,0,"ng-template"),s()}if(e&2){let a,p,_,k,J,ye,be;d("translucent",!0),c(5),j("Pflanze ",i.isEditMode?"bearbeiten":"hinzuf\xFCgen"),c(),d("fullscreen",!0),c(4),d("value",(a=g(11,13,i.plantForm$))==null?null:a.imageUrl),c(3),d("value",(p=g(14,15,i.plantForm$))==null?null:p.nameLatin),c(3),d("value",(_=g(17,17,i.plantForm$))==null?null:_.nameGerman),c(5),d("range",i.distanceRange)("value",(k=g(22,19,i.plantForm$))==null?null:k.height),c(3),d("range",i.monthRange)("value",(J=g(25,21,i.plantForm$))==null?null:J.bloomTime),c(7),d("range",i.distanceRange)("value",(ye=g(32,23,i.plantForm$))==null?null:ye.distance),c(10),N(i.checkboxFields),c(3),d("value",(be=g(45,25,i.plantForm$))==null?null:be.notice)}},dependencies:[ae,re,se,pe,x,q,oe,$e,Be,A,$,rt,ue,I,L,st,pt,ct,mt,dt,ut,We,ht,ie,ne,F],styles:[".text-area[_ngcontent-%COMP%]{min-height:160px;margin-top:8px}"]});let o=n;return o})();export{oo as AddPlantPage};
